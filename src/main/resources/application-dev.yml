# =======================================================
# 토마토리멤버 개발서버 환경 설정 (JWT 인증 시스템 추가)
# =======================================================

server:
  port: ${SERVER_PORT:8096}  # 기존 설정 유지
  servlet:
    session:
      cookie:
        secure: false

spring:
  # =======================================================
  # JPA 설정 (개발서버용)
  # =======================================================
  jpa:
    hibernate:
      ddl-auto: update  # 기존 설정 유지 (스키마 검증만)
    show-sql: false       # 개발서버에서는 SQL 로그 비활성화

  # =======================================================
  # 🔐 JWT 보안 설정 (개발서버용)
  # =======================================================
  security:
    jwt:
      # 개발서버용 시크릿 키
      admin-secret: ZGV2QWRtaW5TZWNyZXRLZXlGb3JUb21hdG9SZW1lbWJlckFkbWluVG9rZW5HZW5lcmF0aW9uRGV2
      member-secret: ZGV2TWVtYmVyU2VjcmV0S2V5Rm9yVG9tYXRvUmVtZW1iZXJNZW1iZXJUb2tlbkdlbmVyYXRpb25EZXY=

      # 개발서버용 토큰 만료 시간
      access-token-expiration: 7200000     # 2시간
      refresh-token-expiration: 604800000  # 1주
      auto-login-expiration: 2592000000    # 1개월

      # 🍪 IP 주소 환경 최적화 쿠키 설정
      cookie:
        secure: false           # HTTP 사용
        same-site: Lax         # IP 주소에서는 None이 더 안전 (Lax 대신)
        domain: ""              # IP 주소에서는 domain 설정하지 않음 (중요!)
        path: /                 # 전체 경로
        http-only: true         # JavaScript 접근 차단 유지

  # =======================================================
  # 데이터소스 설정 (기존 설정 유지)
  # =======================================================
  datasource:
#    url: ${DB_URL:jdbc:log4jdbc:mariadb://127.0.0.1:3306/tomato_remember}  # DB명만 변경
    url: ${DB_URL:jdbc:log4jdbc:mariadb://localhost:3307/remember}  # DB명 변경
#    url: ${DB_URL:jdbc:log4jdbc:mariadb://114.31.52.64:3306/tomato_remember}
    driver-class-name: net.sf.log4jdbc.sql.jdbcapi.DriverSpy
#    username: ${DB_ID:aml60}
    username: ${DB_ID:root}
    password: ${DB_PW:root}
#    password: ${DB_PW:aml60}
    hikari:
      connection-timeout: 30000
      maximum-pool-size: 10
      minimum-idle: 1
      connection-test-query: SELECT 1
      idle-timeout: 600000
      pool-name: ${spring.application.name}-pool

  # =======================================================
  # 파일 업로드/표시 설정 (기존 설정 유지)
  # =======================================================
app:
  file:
    upload-dir: /home/nara/uploads/dev
    base-url: http://114.31.52.64:8096

# =======================================================
# 🔐 토마토리멤버 개발서버 보안 설정
# =======================================================
tomato-remember:
  security:
    # CORS 설정 (개발서버용)
    cors:
      allowed-origins:
        - http://114.31.52.64:8096
        - http://localhost:3000  # 로컬 개발 지원
      allow-credentials: true

# =======================================================
# Google 서비스 설정 (기존 설정 유지)
# =======================================================
google:
  key-path:
    console: /google/pc-api-6501066511374588335-380-1ad7a0f489f4.json
    firebase: /firebase/dev-bread-4908a-firebase-adminsdk-cp247-2bc9dd1010.json

# =======================================================
# 개발서버 로깅 설정 (JWT 인증 로깅 추가)
# =======================================================
logging:
  level:
    com.tomato.remember: INFO
    org.springframework.web: INFO
    org.springframework.security: INFO
    # JWT 인증 관련 로깅 (개발서버에서는 중간 레벨)
    com.tomato.remember.common.security: DEBUG
    com.tomato.remember.common.util.CookieUtil: DEBUG
    org.thymeleaf: DEBUG
    org.springframework.web.servlet.view: DEBUG

# =======================================================
# 개발서버용 JWT 설정
# =======================================================
debug:
  jwt:
    enabled: false  # 개발서버에서는 JWT 디버깅 비활성화
    print-claims: false
    print-headers: false
# =======================================================
# 스웨거 환경별 설정
# =======================================================
springdoc:
  swagger-ui:
    enabled: true
    # 로컬 개발 시 추가 설정
    deep-linking: true
    display-operation-id: true
    show-extensions: true