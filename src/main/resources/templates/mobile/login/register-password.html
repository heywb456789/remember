<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta name="format-detection" content="telephone=no"/>
  <title th:text="${pageTitle} ?: '비밀번호 설정 - 토마토리멤버'">비밀번호 설정 - 토마토리멤버</title>

  <!-- Bootstrap CSS -->
  <link th:href="@{/bootstrap/css/bootstrap.css}" rel="stylesheet"/>

  <!-- Custom CSS -->
  <link th:href="@{/assets/mobile/css/register-password.css}" rel="stylesheet"/>
</head>
<body>
  <div class="register-password-container">
    <!-- 헤더 -->
    <div class="register-password-header">
      <div class="header-left">
        <button class="back-button" onclick="history.back()" aria-label="뒤로가기">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 18l-6-6 6-6"/>
          </svg>
        </button>
      </div>

      <div class="header-center">
        <img th:src="@{/images/new_main_logo.png}" alt="토마토리멤버" class="etomato-logo">
        <h1 class="page-title">OneID 회원가입</h1>
      </div>

      <div class="header-right">
        <!-- 오른쪽 공간 확보용 -->
      </div>
    </div>

    <!-- 메인 컨텐츠 -->
    <div class="register-password-content">
      <!-- 웰컴 메시지 -->
      <div class="welcome-section">
        <h2 class="welcome-title">증권통, 뉴스통, 통통 등 토마토그룹의 다양한 서비스를 One-ID 하나로 편리하게 이용할 수 있습니다.</h2>
      </div>

      <!-- 그룹사 로고 섹션 -->
      <div class="company-logos-section">
        <div class="logos-container">
          <img th:src="@{/images/signup_middle.png}" alt="토마토그룹 서비스" class="group-logo">
        </div>
      </div>

      <!-- 비밀번호 입력 폼 -->
      <div class="form-section">
        <div class="form-group">
          <label for="password" class="form-label">비밀번호</label>
          <div class="password-input-container">
            <input type="password"
                   class="password-input"
                   id="password"
                   placeholder="영문, 숫자, 특수문자 조합 8자 이상"
                   autocomplete="new-password">
            <button type="button" class="password-toggle" id="passwordToggle" aria-label="비밀번호 보기/숨기기">
              <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="eye-off-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div class="password-requirements" id="passwordRequirements">
            <ul class="requirements-list">
              <li class="requirement" data-requirement="length">
                <span class="requirement-icon">○</span>
                <span class="requirement-text">8자 이상</span>
              </li>
              <li class="requirement" data-requirement="letter">
                <span class="requirement-icon">○</span>
                <span class="requirement-text">영문 포함</span>
              </li>
              <li class="requirement" data-requirement="number">
                <span class="requirement-icon">○</span>
                <span class="requirement-text">숫자 포함</span>
              </li>
              <li class="requirement" data-requirement="special">
                <span class="requirement-icon">○</span>
                <span class="requirement-text">특수문자 포함</span>
              </li>
            </ul>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword" class="form-label">비밀번호 확인</label>
          <div class="password-input-container">
            <input type="password"
                   class="password-input"
                   id="confirmPassword"
                   placeholder="비밀번호를 다시 입력하세요"
                   autocomplete="new-password">
            <button type="button" class="password-toggle" id="confirmPasswordToggle" aria-label="비밀번호 확인 보기/숨기기">
              <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
              <svg class="eye-off-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/>
                <line x1="1" y1="1" x2="23" y2="23"/>
              </svg>
            </button>
          </div>
          <div class="password-match-message" id="passwordMatchMessage" style="display: none;">
            <span class="match-text">비밀번호가 일치합니다</span>
          </div>
          <div class="password-error-message" id="passwordErrorMessage" style="display: none;">
            <span class="error-text">비밀번호가 일치하지 않습니다</span>
          </div>
        </div>
      </div>

      <!-- 회원가입 버튼 -->
      <button type="button" class="register-button" id="registerButton" disabled>
        <span class="button-text">회원가입 완료</span>
        <div class="button-loading" style="display: none;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12a9 9 0 11-6.219-8.56"/>
          </svg>
        </div>
      </button>
    </div>
  </div>

  <!-- 성공 모달 -->
  <div class="modal-overlay" id="successModal" style="display: none;">
    <div class="modal-container success-modal">
      <div class="modal-header">
        <div class="success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20,6 9,17 4,12"/>
          </svg>
        </div>
        <h3 class="modal-title">회원가입 완료!</h3>
      </div>
      <div class="modal-body">
        <p>토마토리멤버 가입을 환영합니다.<br>이제 모든 서비스를 이용하실 수 있습니다.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="modal-confirm-button" id="successConfirm">
          <span>시작하기</span>
        </button>
      </div>
    </div>
  </div>

  <!-- 에러 모달 -->
  <div class="modal-overlay" id="errorModal" style="display: none;">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">오류</h3>
      </div>
      <div class="modal-body">
        <p id="errorMessage">오류가 발생했습니다.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="modal-confirm-button" id="errorConfirm">
          <span>확인</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script th:src="@{/bootstrap/js/bootstrap.bundle.js}"></script>

  <!-- 비밀번호 설정 JavaScript -->
  <script type="module" th:src="@{/assets/mobile/js/register-password.js}"></script>

  <!-- 전역 설정 -->
  <script th:inline="javascript">
    // API 엔드포인트 설정
    window.API_ENDPOINTS = {
      REGISTER: /*[[${registerApiUrl}]]*/ '/api/auth/register'
    };

    // 페이지 설정
    window.PAGE_CONFIG = {
      prevUrl: /*[[${prevUrl}]]*/ '/mobile/register/verify',
      homeUrl: /*[[${homeUrl}]]*/ '/mobile/home'
    };

    console.log('🔧 Register password page config loaded');
  </script>
</body>
</html>