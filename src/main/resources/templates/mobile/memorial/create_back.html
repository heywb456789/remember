<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{mobile/layout/default :: html(
        ~{::title},
        ~{::section},
        ~{::customCSS},
        ~{::customJS},
        'memorial',
        'create'
      )}">
<head>
  <title>ë©”ëª¨ë¦¬ì–¼ ë“±ë¡ - í† ë§ˆí† ë¦¬ë©¤ë²„</title>

  <!-- Custom CSS -->
  <customCSS>
    <link th:href="@{/assets/mobile/css/memorial-create.css}" rel="stylesheet">
  </customCSS>
</head>
<body>
<section>
  <div class="container">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="page-header">
      <button class="back-btn" type="button" onclick="history.back()">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h1 class="page-title">ë©”ëª¨ë¦¬ì–¼ ë“±ë¡</h1>
    </div>

    <!-- ì§„í–‰ ìƒíƒœ í‘œì‹œ -->
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" style="width: 25%"></div>
      </div>
      <div class="progress-steps">
        <div class="step active">
          <div class="step-number">1</div>
          <div class="step-label">ê¸°ë³¸ ì •ë³´</div>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <div class="step-label">ê³ ì¸ ì •ë³´</div>
        </div>
        <div class="step">
          <div class="step-number">3</div>
          <div class="step-label">ë¯¸ë””ì–´</div>
        </div>
        <div class="step">
          <div class="step-number">4</div>
          <div class="step-label">ì™„ë£Œ</div>
        </div>
      </div>
    </div>

    <!-- ë©”ëª¨ë¦¬ì–¼ ë“±ë¡ í¼ -->
    <form id="memorialCreateForm" class="memorial-form">
      <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
      <div class="form-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-user"></i>
            ê¸°ë³¸ ì •ë³´
          </h2>
          <p class="section-description">ë©”ëª¨ë¦¬ì–¼ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        </div>

        <div class="form-group">
          <label for="memorialName" class="form-label">ë©”ëª¨ë¦¬ì–¼ ì´ë¦„ <span class="required">*</span></label>
          <input type="text" id="memorialName" name="name" class="form-input"
                 placeholder="ì˜ˆ: ê¹€í• ë¨¸ë‹ˆì˜ ì¶”ì–µ"
                 maxlength="50" required>
          <div class="form-help">ë©”ëª¨ë¦¬ì–¼ì„ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
          <div class="validation-message" id="memorialNameError"></div>
        </div>

        <div class="form-group">
          <label for="memorialDescription" class="form-label">ë©”ëª¨ë¦¬ì–¼ ì„¤ëª…</label>
          <textarea id="memorialDescription" name="description" class="form-input"
                    placeholder="ê³ ì¸ì„ ê°„ë‹¨íˆ ì†Œê°œí•´ì£¼ì„¸ìš”."
                    maxlength="500" rows="3"></textarea>
          <div class="form-help">ë©”ëª¨ë¦¬ì–¼ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì„ íƒì‚¬í•­)</div>
        </div>

        <div class="form-group">
          <label class="form-label">ê³µê°œ ì„¤ì •</label>
          <div class="radio-group">
            <label class="radio-option">
              <input type="radio" name="isPublic" value="false" checked>
              <span class="radio-indicator"></span>
              <div class="radio-content">
                <div class="radio-title">ë¹„ê³µê°œ</div>
                <div class="radio-description">ê°€ì¡±ê³¼ ì§€ì¸ë“¤ë§Œ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
              </div>
            </label>
            <label class="radio-option">
              <input type="radio" name="isPublic" value="true">
              <span class="radio-indicator"></span>
              <div class="radio-content">
                <div class="radio-title">ê³µê°œ</div>
                <div class="radio-description">ëª¨ë“  ì‚¬ëŒì´ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
              </div>
            </label>
          </div>
        </div>
      </div>

      <!-- ê³ ì¸ ì •ë³´ ì„¹ì…˜ -->
      <div class="form-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-heart"></i>
            ê³ ì¸ ì •ë³´
          </h2>
          <p class="section-description">ê³ ì¸ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        </div>

        <div class="form-group">
          <label for="deceasedName" class="form-label">ê³ ì¸ ì´ë¦„ <span class="required">*</span></label>
          <input type="text" id="deceasedName" name="deceasedName" class="form-input"
                 placeholder="ì˜ˆ: ê¹€í• ë¨¸ë‹ˆ"
                 maxlength="30" required>
          <div class="validation-message" id="deceasedNameError"></div>
        </div>

        <div class="form-group">
          <label class="form-label">ì„±ë³„ <span class="required">*</span></label>
          <div class="gender-options">
            <label class="gender-card">
              <input type="radio" name="gender" value="MALE" required>
              <div class="gender-icon">
                <i class="fas fa-mars"></i>
              </div>
              <span>ë‚¨ì„±</span>
            </label>
            <label class="gender-card">
              <input type="radio" name="gender" value="FEMALE" required>
              <div class="gender-icon">
                <i class="fas fa-venus"></i>
              </div>
              <span>ì—¬ì„±</span>
            </label>
          </div>
          <div class="validation-message" id="genderError"></div>
        </div>

        <div class="form-group">
          <label class="form-label">ë‚˜ì™€ì˜ ê´€ê³„ <span class="required">*</span></label>
          <select id="relationship" name="relationship" class="form-select" required>
            <option value="">ê´€ê³„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
            <option value="PARENT">ë¶€ëª¨</option>
            <option value="GRANDPARENT">ì¡°ë¶€ëª¨</option>
            <option value="SPOUSE">ë°°ìš°ì</option>
            <option value="SIBLING">í˜•ì œìë§¤</option>
            <option value="CHILD">ìë…€</option>
            <option value="GRANDCHILD">ì†ìë…€</option>
            <option value="RELATIVE">ì¹œì²™</option>
            <option value="FRIEND">ì¹œêµ¬</option>
            <option value="OTHER">ê¸°íƒ€</option>
          </select>
          <div class="validation-message" id="relationshipError"></div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="birthDate" class="form-label">ìƒë…„ì›”ì¼</label>
            <input type="date" id="birthDate" name="birthDate" class="form-input">
            <div class="validation-message" id="birthDateError"></div>
          </div>
          <div class="form-group">
            <label for="deathDate" class="form-label">ê¸°ì¼</label>
            <input type="date" id="deathDate" name="deathDate" class="form-input">
            <div class="validation-message" id="deathDateError"></div>
          </div>
        </div>
      </div>

      <!-- í¼ ì•¡ì…˜ ë²„íŠ¼ -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="history.back()">
          <i class="fas fa-arrow-left"></i>
          ì´ì „
        </button>
        <button type="submit" class="btn btn-primary">
          ë‹¤ìŒ ë‹¨ê³„
          <i class="fas fa-arrow-right"></i>
        </button>
      </div>
    </form>

    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
      <div class="loading-text">ë©”ëª¨ë¦¬ì–¼ì„ ìƒì„±í•˜ê³  ìˆì–´ìš”...</div>
    </div>
  </div>
</section>

<!-- Custom JavaScript -->
<customJS>
  <!-- ì„œë²„ ì‚¬ì´ë“œ ë°ì´í„° ì „ë‹¬ -->
  <script th:inline="javascript">
    window.memorialStep1Data = {
      currentStep: 1,
      maxStep: 4,
      formData: {
        name: '',
        description: '',
        isPublic: false,
        deceasedName: '',
        gender: '',
        relationship: '',
        birthDate: '',
        deathDate: ''
      },
      validation: {
        rules: {
          name: { required: true, minLength: 2, maxLength: 50 },
          deceasedName: { required: true, minLength: 2, maxLength: 30 },
          gender: { required: true },
          relationship: { required: true }
        }
      },
      urls: {
        createStep1: '/api/memorial/create/step1',
        nextStep: '/memorial/create/step2'
      }
    };

    // ê°œë°œ ëª¨ë“œ í™œì„±í™”
    if (window.location.search.includes('debug=true')) {
      window.debugMode = true;
      console.log('ğŸ”§ ë©”ëª¨ë¦¬ì–¼ ë“±ë¡ 1ë‹¨ê³„ ë””ë²„ê·¸ ëª¨ë“œ í™œì„±í™”');
      console.log('ğŸ“Š 1ë‹¨ê³„ ë°ì´í„°:', window.memorialStep1Data);
    }
  </script>

  <!-- ë©”ëª¨ë¦¬ì–¼ ë“±ë¡ 1ë‹¨ê³„ JavaScript ë¡œë“œ -->
  <script th:src="@{/assets/mobile/js/memorial-create-step1.js}" type="module"></script>
</customJS>
</body>
</html>